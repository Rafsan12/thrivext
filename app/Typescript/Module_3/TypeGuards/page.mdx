# Typeguards
## ЁЯЫбя╕П ржЯрж╛ржЗржк ржЧрж╛рж░рзНржб (Type Guards) ржХрзА?

**Type Guards** рж╣рж▓рзЛ TypeScript-ржПрж░ ржПржХржЯрж┐ ржХрзМрж╢рж▓, ржпрж╛ ржЗржЙржирж┐ржпрж╝ржи ржЯрж╛ржЗржк (`|`) ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рж▓рзЗ **ржнрж┐рждрж░рзЗ ржХржирзНржбрж┐рж╢ржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржЯрж╛ржЗржк рж╢ржирж╛ржХрзНржд** ржХрж░рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗред ржПржЯрж┐ ржХрзЛржбржХрзЗ ржирж┐рж░рж╛ржкржж, ржирж┐рж░рзНржнрзБрж▓ ржПржмржВ ржЯрж╛ржЗржк ржЕржирзБржпрж╛рзЯрзА ржЖржЪрж░ржг ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзЗред


## тЬи ржЯрж╛ржЗржк ржЧрж╛рж░рзНржбрзЗрж░ ржзрж░ржирж╕ржорзВрж╣

### 1я╕ПтГг `typeof` ржЧрж╛рж░рзНржб (ржкрзНрж░рж┐ржорж┐ржЯрж┐ржн ржЯрж╛ржЗржк ржЪрзЗржХ ржХрж░рж╛рж░ ржЬржирзНржп)

```tsx
// type guard with typeof

type ADD = string | number;
const Add = (param1: ADD, param2: ADD): ADD => {
  if (typeof param1 === "number" && typeof param2 === "number") {
    return param1 + param2;
  } else {
    return param1.toString() + param2.toString();
  }
};

const res1 = Add(2, 3);
const res2 = Add("5", "5");

console.log(res1, res2);

```

ЁЯФН ржПржЦрж╛ржирзЗ `param1` ржПржмржВ `param2` ржПрж░ ржЯрж╛ржЗржк `string | number`ред ржЖржорж░рж╛ `typeof` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЪрзЗржХ ржХрж░рзЗржЫрж┐ рждрж╛рж░рж╛ `number` ржХрж┐ржирж╛ред

ЁЯУМ ржпржжрж┐ рж╣рзЯ, рждрж╛рж╣рж▓рзЗ ржпрзЛржЧржлрж▓ ржХрж░ржмред ржпржжрж┐ ржирж╛ рж╣рзЯ, рждрж╛рж╣рж▓рзЗ рж╕рзНржЯрзНрж░рж┐ржВ ржХржиржХрзНржпрж╛ржЯ ржХрж░ржмред

ЁЯУМ **ржмрзНржпржмрж╣рж╛рж░рзЗрж░ рж╕ржорзЯ**: ржпржЦржи ржкрзНрж░рж┐ржорж┐ржЯрж┐ржн ржЯрж╛ржЗржк ржпрзЗржоржи `string`, `number`, `boolean` ржЪрзЗржХ ржХрж░рждрзЗ рж╣ржмрзЗред

---

### 2я╕ПтГг `in` ржЧрж╛рж░рзНржб (ржЕржмржЬрзЗржХрзНржЯ ржЯрж╛ржЗржкрзЗрж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржЪрзЗржХ ржХрж░рж╛рж░ ржЬржирзНржп)

```tsx
// in guard

type NormalUser = {
  name: string;
};
type AdminUser = {
  name: string;
  role: "admin";
};

const getUser = (user: NormalUser | AdminUser) => {
  if ("role" in user) {
    // ржПржЦржи ржЖржорж░рж╛ admin ржЯрж╛ржЗржкрзЗрж░ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХрж░рждрзЗ ржкрж╛рж░рж┐
    console.log(`I am ${user.name} & My role is ${user.role}`);
  } else {
    console.log(`I am ${user.name}`);
  }
};

const normalUser: NormalUser = {
  name: "I am a NormalUser",
};
const adminUser: AdminUser = {
  name: "I am an Admin",
  role: "admin",
};

getUser(normalUser);
getUser(adminUser);

```

ЁЯФН ржПржЦрж╛ржирзЗ `user` ржЯрж╛ржЗржк рж╣рждрзЗ ржкрж╛рж░рзЗ `NormalUser` ржЕржержмрж╛ `AdminUser`ред `in` ржЧрж╛рж░рзНржб ржжрж┐рзЯрзЗ ржЪрзЗржХ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ `role` ржирж╛ржорзЗрж░ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржЖржЫрзЗ ржХрж┐ржирж╛ред

ЁЯУМ ржпржжрж┐ ржерж╛ржХрзЗ рждрж╛рж╣рж▓рзЗ рж╕рзЗржЯрж╛ `AdminUser`ред

ЁЯУМ **ржмрзНржпржмрж╣рж╛рж░рзЗрж░ рж╕ржорзЯ**: ржпржЦржи ржЕржмржЬрзЗржХрзНржЯрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржЖржЫрзЗ ржХрж┐ржирж╛ ржЪрзЗржХ ржХрж░рждрзЗ ржЪрж╛ржЗред

---

### 3я╕ПтГг `instanceof` ржЧрж╛рж░рзНржб (ржХрзНрж▓рж╛рж╕ ржнрж┐рждрзНрждрж┐ржХ ржЯрж╛ржЗржк ржЪрзЗржХ ржХрж░рж╛рж░ ржЬржирзНржп)

```tsx
class Animal {
  makeSound() {
    console.log("Animal sound");
  }
}
class Dog extends Animal {
  makeBark() {
    console.log("Bark!");
  }
}
class Cat extends Animal {
  makeMeaw() {
    console.log("Meaw!");
  }
}

const isDog = (animal: Animal): animal is Dog => {
  return animal instanceof Dog;
};
const isCat = (animal: Animal): animal is Cat => {
  return animal instanceof Cat;
};

const getAnimal = (animal: Animal) => {
  if (isDog(animal)) {
    animal.makeBark();
  } else if (isCat(animal)) {
    animal.makeMeaw();
  } else {
    animal.makeSound();
  }
};

```

ЁЯФН ржПржЦрж╛ржирзЗ `Animal` ржХрзНрж▓рж╛рж╕ ржЖржЫрзЗ ржПржмржВ `Dog` ржУ `Cat` ржХрзНрж▓рж╛рж╕ рждрж╛рж░ рж╕рж╛ржмржХрзНрж▓рж╛рж╕ред `instanceof` ржжрж┐рзЯрзЗ ржЪрзЗржХ ржХрж░ржЫрж┐ `animal` ржЖрж╕рж▓рзЗ ржХрзЛржи рж╕рж╛ржмржХрзНрж▓рж╛рж╕рзЗрж░ ржЕржмржЬрзЗржХрзНржЯред

ЁЯУМ **ржмрзНржпржмрж╣рж╛рж░рзЗрж░ рж╕ржорзЯ**: ржпржЦржи ржХрзНрж▓рж╛рж╕ ржнрж┐рждрзНрждрж┐ржХ ржЕржмржЬрзЗржХрзНржЯрзЗрж░ ржЗржирж╕рзНржЯрзНржпрж╛ржирзНрж╕ ржпрж╛ржЪрж╛ржЗ ржХрж░рждрзЗ рж╣рзЯред

---

## ЁЯзй ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржкрзНрж░рзЯрзЛржЬржирзАрзЯрждрж╛

| ржХрж╛рж░ржг | ржмрзНржпрж╛ржЦрзНржпрж╛ |
| --- | --- |
| ЁЯФН **ржЯрж╛ржЗржк ржЪрзЗржХ ржХрж░рждрзЗ** | ржпржжрж┐ ржнрзЗрж░рж┐рзЯрзЗржмрж▓ ржПржХрж╛ржзрж┐ржХ ржЯрж╛ржЗржкрзЗрж░ рж╣рзЯ, рждржмрзЗ ржирж┐рж╢рзНржЪрж┐рждржнрж╛ржмрзЗ ржЪрзЗржХ ржХрж░рждрзЗ рж╣рзЯ ржХрзЛржи ржЯрж╛ржЗржкржЯрж┐ ржмрзНржпржмрж╣рзГржд рж╣ржЪрзНржЫрзЗ |
| ЁЯЫбя╕П **ржЯрж╛ржЗржк рж╕рзЗржлржЯрж┐ ржмрж╛рзЬрж╛рждрзЗ** | ржнрзБрж▓ ржЯрж╛ржЗржкрзЗ ржЕржкрж╛рж░рзЗрж╢ржи ржХрж░рж▓рзЗ ржЯрж╛ржЗржкрж╕рзНржХрзНрж░рж┐ржкрзНржЯрзЗ ржПрж░рж░ рж╣рзЯ ржирж╛, ржХрж┐ржирзНрждрзБ рж░рж╛ржиржЯрж╛ржЗржорзЗ рж╕ржорж╕рзНржпрж╛ рж╣рждрзЗ ржкрж╛рж░рзЗ |
| тЪЩя╕П **ржнрж┐ржирзНржи ржЯрж╛ржЗржк ржЕржирзБржпрж╛рзЯрзА рж▓ржЬрж┐ржХ ржкрзНрж░рзЯрзЛржЧ ржХрж░рждрзЗ** | ржмрж┐ржнрж┐ржирзНржи ржЯрж╛ржЗржк ржЕржирзБржпрж╛рзЯрзА ржнрж┐ржирзНржиржнрж╛ржмрзЗ ржЖржЪрж░ржг ржХрж░рж╛рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗ |
| **тЬЕ рж░рж╛ржиржЯрж╛ржЗржо ржПрж░рж░ ржХржорж╛рзЯ** | ржЯрж╛ржЗржк ржарж┐ржХржнрж╛ржмрзЗ рж╣рзНржпрж╛ржирзНржбрзЗрж▓ ржХрж░рж▓рзЗ ржЕрзНржпрж╛ржк ржХрзНрж░рзНржпрж╛рж╢рзЗрж░ рж╕ржорзНржнрж╛ржмржирж╛ ржХржорзЗ |

## ЁЯз╛ рж╕ржВржХрзНрж╖рзЗржкрзЗ

| ржЯрж╛ржЗржк ржЧрж╛рж░рзНржб | ржХржЦржи ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯ | ржХрзА ржЪрзЗржХ ржХрж░рзЗ |
| --- | --- | --- |
| `typeof` | ржкрзНрж░рж┐ржорж┐ржЯрж┐ржн ржЯрж╛ржЗржк (string, number ржЗрждрзНржпрж╛ржжрж┐) | ржЯрж╛ржЗржк ржирж╛ржо (`"string"`, `"number"`) |
| `in` | ржЕржмржЬрзЗржХрзНржЯрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржЖржЫрзЗ ржХрж┐ржирж╛ | ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржирж╛ржо (`"role" in user`) |
| `instanceof` | ржХрзНрж▓рж╛рж╕ ржнрж┐рждрзНрждрж┐ржХ ржЗржирж╕рзНржЯрзНржпрж╛ржирзНрж╕ ржпрж╛ржЪрж╛ржЗ | рж╕рж╛ржмржХрзНрж▓рж╛рж╕ ржЗржирж╕рзНржЯрзНржпрж╛ржирзНрж╕ ржХрж┐ржирж╛ |