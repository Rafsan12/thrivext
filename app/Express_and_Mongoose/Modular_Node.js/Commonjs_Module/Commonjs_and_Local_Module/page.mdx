# CommonJS & Local Module

ржПржЗ ржнрж┐ржбрж┐ржУрждрзЗ ржЖржорж░рж╛ **CommonJS** ржПржмржВ **Local Module** ржирж┐рзЯрзЗ ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд ржЬрж╛ржиржмрзЛред Node.js-ржП ржорзВрж▓ржд рзй ржзрж░ржирзЗрж░ ржоржбрж┐ржЙрж▓ ржЖржЫрзЗ:

1. **Local Module** тАФ ржирж┐ржЬрзЗрж░ рждрзИрж░рж┐
2. **Built-in Module** тАФ Node.js ржПрж░ ржирж┐ржЬрж╕рзНржм
3. **Third-party Module** тАФ ржЕржирзНржпржжрзЗрж░ рждрзИрж░рж┐, npm ржерзЗржХрзЗ ржирзЗржУрзЯрж╛

---

## ЁЯЫая╕П Local Module рждрзИрж░рж┐

ржПржХржЯрж╛ ржлрж╛ржЗрж▓ ржерзЗржХрзЗ ржХрзЛржб **export** ржХрж░рзЗ ржЕржирзНржп ржлрж╛ржЗрж▓рзЗ **require** ржПрж░ ржорж╛ржзрзНржпржорзЗ **import** ржХрж░рж▓рзЗ рж╕рзЗржЯрж╛ ржПржХржЯрж╛ **Module** рж╣рзЯрзЗ ржпрж╛рзЯред

### ржЙржжрж╛рж╣рж░ржг:

### ЁЯФ╣ File Structure:

```
Learning-Node/
тФЬтФАтФА file1.js
тФФтФАтФА file2.js
```

---

### ЁЯФ╕ file2.js

```jsx
const a = 10;
module.exports = a;
```

ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `a` ржирж╛ржорзЗрж░ ржПржХржЯрж╛ ржнрзЗрж░рж┐рзЯрзЗржмрж▓ ржбрж┐ржХрзНрж▓рзЗрзЯрж╛рж░ ржХрж░рзЗржЫрж┐ ржПржмржВ `module.exports` ржжрж┐рзЯрзЗ ржПржХрзНрж╕ржкрзЛрж░рзНржЯ ржХрж░рзЗржЫрж┐ред

---

### ЁЯФ╕ file1.js

```jsx
const var_1 = require('./file2');
console.log(var_1); // 10
```

ржЖржорж░рж╛ `file2.js` ржХрзЗ `require('./file2')` ржжрж┐рзЯрзЗ ржЗржоржкрзЛрж░рзНржЯ ржХрж░ржЫрж┐ ржПржмржВ рж╕рзЗржЯрж╛ `var_1` ржнрзЗрж░рж┐рзЯрзЗржмрж▓рзЗ рж░рзЗржЦрзЗ ржХржирж╕рзЛрж▓рзЗ ржкрзНрж░рж┐ржирзНржЯ ржХрж░ржЫрж┐ред

---

## тЪая╕П ржпржжрж┐ Export ржирж╛ ржХрж░рж┐?

ржпржжрж┐ ржЖржорж░рж╛ `file2.js` ржерзЗржХрзЗ ржХрж┐ржЫрзБ **export** ржирж╛ ржХрж░рж┐, рждрж╛рж╣рж▓рзЗ `require` ржХрж░рж▓рзЗ ржЖржорж░рж╛ **empty object `{}`** ржкрж╛ржм:

```jsx
// file2.js
const a = 10;
// No module.exports

// file1.js
const var_1 = require('./file2');

console.log(var_1); // {}
```

---

## ЁЯФН module ржПрж░ ржнрзЗрждрж░рзЗ ржХрзА ржерж╛ржХрзЗ?

ржЖржорж░рж╛ ржЪрж╛ржЗрж▓рзЗржЗ `console.log(module)` ржХрж░рзЗ ржжрзЗржЦрзЗ ржирж┐рждрзЗ ржкрж╛рж░рж┐ module object-ржПрж░ ржоржзрзНржпрзЗ ржХрж┐ ржХрж┐ ржЖржЫрзЗред

```jsx
console.log(module);
```

### ЁЯз╛ Output:

```bash
Module {
  id: '.',
  path: '/Users/your-username/Desktop/Learning-Node',
  exports: {},
  filename: '/Users/your-username/Desktop/Learning-Node/file2.js',
  loaded: false,
  children: [],
  paths: [
    '/Users/your-username/Desktop/Learning-Node/node_modules',
    '/Users/your-username/Desktop/node_modules',
    '/Users/your-username/node_modules',
    '/Users/node_modules',
    '/node_modules'
  ]
}
```

---

### ЁЯза ржмрзНржпрж╛ржЦрзНржпрж╛:

| ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ | ржорж╛ржирзЗ ржХрж┐ |
| --- | --- |
| `id` | ржоржбрж┐ржЙрж▓рзЗрж░ ржЖржЗржбрж┐, `.` ржорж╛ржирзЗ ржПржЯрж╛ main/root module |
| `path` | ржпрзЗржЦрж╛ржи ржерзЗржХрзЗ module рж▓рзЛржб рж╣рзЯрзЗржЫрзЗ |
| `exports` | ржпрзЗржЯрж╛ ржЕржирзНржп ржлрж╛ржЗрж▓ ржерзЗржХрзЗ ржкрж╛ржмрзЗ (ржпржжрж┐ ржХрж┐ржЫрзБ export ржХрж░рж╛ рж╣рзЯ) |
| `filename` | ржкрзВрж░рзНржг ржлрж╛ржЗрж▓ ржкрж╛рже |
| `loaded` | ржоржбрж┐ржЙрж▓ рж▓рзЛржб рж╣рзЯрзЗржЫрзЗ ржХрж┐ржирж╛ (false ржорж╛ржирзЗ ржПржЦржирзЛ рж╕ржорзНржкрзВрж░рзНржг execute рж╣рзЯржирж┐) |
| `children` | ржЕржирзНржп ржоржбрж┐ржЙрж▓ ржЧрзБрж▓рзЛ ржпрзЗржЧрзБрж▓рзЛ require ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ |
| `paths` | ржХрзЛржи ржХрзЛржи ржЬрж╛рзЯржЧрж╛ ржерзЗржХрзЗ `require()` ржЦрзБржБржЬрзЗ ржжрзЗржЦржмрзЗ |

ржПржЦрж╛ржирзЗ ржХрж┐ржЫрзБ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржерж╛ржХржмрзЗ:

- `id`: ржоржбрж┐ржЙрж▓рзЗрж░ ржЗржЙржирж┐ржХ ржЖржЗржбрж┐
- `path`: ржлрж╛ржЗрж▓рзЗрж░ рж▓рзЛржХрзЗрж╢ржи
- `exports`: ржпрзЗржЯрж╛ ржПржХрзНрж╕ржкрзЛрж░рзНржЯ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ
- `filename`, `loaded`, `children`, ржЗрждрзНржпрж╛ржжрж┐...

---

## ЁЯза ржЙржкрж╕ржВрж╣рж╛рж░

| ржмрж┐рж╖рзЯ | ржмрзНржпрж╛ржЦрзНржпрж╛ |
| --- | --- |
| Local Module | ржирж┐ржЬрзЗ ржмрж╛ржирж╛ржирзЛ ржоржбрж┐ржЙрж▓ |
| `module.exports` | ржЕржирзНржп ржлрж╛ржЗрж▓рзЗрж░ ржЬржирзНржп ржбрзЗржЯрж╛ ржПржХрзНрж╕ржкрзЛрж░рзНржЯ ржХрж░рж╛ |
| `require()` | ржЕржирзНржп ржлрж╛ржЗрж▓ ржерзЗржХрзЗ ржбрзЗржЯрж╛ ржЗржоржкрзЛрж░рзНржЯ ржХрж░рж╛ |
| Default return | ржХрж┐ржЫрзБ ржирж╛ export ржХрж░рж▓рзЗ empty object рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рзЗ |

---

ЁЯЪА ржкрж░ржмрж░рзНрждрзА ржзрж╛ржкрзЗ ржЖржорж░рж╛ рж╢рж┐ржЦржмрзЛ Built-in module ржПржмржВ Third-party module ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржкржжрзНржзрждрж┐ред


ржЖржорж░рж╛ ржоржбрзБрж▓рж╛рж░ рж╕рж┐рж╕рзНржЯрзЗржоржХрзЗ ржбрж┐ржк ржбрж╛ржЗржн ржХрж░рзЗ ржмрзЛржЭрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░ржмрзЛред

## ЁЯУБ ржоржбрж┐ржЙрж▓ ржлрж╛ржЗрж▓ рждрзИрж░рж┐

ржЖржЧрзЗрж░ ржнрж┐ржбрж┐ржУрждрзЗ ржЖржорж░рж╛ `file2.js` ржирж╛ржорзЗ ржПржХржЯрж┐ ржлрж╛ржЗрж▓ рждрзИрж░рж┐ ржХрж░рзЗржЫрж┐рж▓рж╛ржо, ржпрзЗржЦрж╛ржирзЗ:

- ржПржХржЯрж┐ `add` ржлрж╛ржВрж╢ржи ржЫрж┐рж▓
- ржжрзБржЯрж┐ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ ржЫрж┐рж▓: `a` ржПржмржВ `b`
- ржЖрж░рзЗржХржЯрж┐ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ ржЫрж┐рж▓
- ржПржмржВ ржлрж╛ржЗрж▓ржЯрж┐ ржоржбрзБрж▓рж╛рж░ ржХрж░рж╛ рж╣рзЯрзЗржЫрж┐рж▓

ржПрж░ржкрж░ ржЖржорж░рж╛ ржЖрж░рзЗржХржЯрж┐ ржлрж╛ржЗрж▓ рждрзИрж░рж┐ ржХрж░рж▓рж╛ржо `file3.js`, ржпрзЗржЦрж╛ржирзЗ:

- ржЖржмрж╛рж░ ржПржХржЯрж┐ `add` ржлрж╛ржВрж╢ржи ржерж╛ржХржмрзЗ
- `b` ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ржЯрж┐ржУ рж░рж╛ржЦрж╛ рж╣ржмрзЗ

ржПржнрж╛ржмрзЗ ржЖржорж░рж╛ `file3.js`-ржХрзЗржУ ржоржбрж┐ржЙрж▓ рж╣рж┐рж╕рзЗржмрзЗ ржЧржаржи ржХрж░рж▓рж╛ржоред

---

## ЁЯза Alias ржмрзНржпржмрж╣рж╛рж░: ржирж╛ржо ржХржиржлрзНрж▓рж┐ржХрзНржЯ рж╕ржорж╛ржзрж╛ржи

`file1.js` ржП ржЖржорж░рж╛ `const` ржПржмржВ `destructuring` ржХрж░рзЗ ржХрж╛ржЬ ржХрж░рзЗржЫрж┐рж▓рж╛ржоред

ржзрж░рзБржи, ржЖржорж░рж╛ `a` ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ржЯрж┐ржХрзЗ ржирждрзБржи ржирж╛ржорзЗ ржирж┐рждрзЗ ржЪрж╛ржЗ, рждржЦржи **alias** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯред

### ржЙржжрж╛рж╣рж░ржг:

```jsx
const { add: a3 } = require('./file3');
```

ржПржЦрж╛ржирзЗ `add` ржлрж╛ржВрж╢ржиржХрзЗ `a3` ржирж╛ржорзЗ ржирж┐ржЪрзНржЫрж┐ ржХрж╛рж░ржг ржПржЯрж╛ `file3` ржерзЗржХрзЗ ржЖрж╕ржЫрзЗред

ЁЯФ╣ ржПржЦржи ржпржжрж┐ ржЖржорж░рж╛ `2 + 3` ржХрж░рж┐, ржлрж▓рж╛ржлрж▓ рж╣ржмрзЗ `5`ред

---

## ЁЯз╣ ржХрзЛржб ржкрж░рж┐рж╖рзНржХрж╛рж░ ржУ alias ржкрзНрж░рзЯрзЛржЬржирзАрзЯрждрж╛

- ржЖржорж░рж╛ **dot notation** ржмрж╛ **destructuring** ржЙржнржпрж╝ржнрж╛ржмрзЗржЗ ржХрзЛржб ржкрж░рж┐рж╖рзНржХрж╛рж░ рж░рж╛ржЦрждрзЗ ржкрж╛рж░рж┐ред
- ржпржЦржи ржлрж╛ржВрж╢ржи ржмрж╛ ржнрзЗрж░рж┐ржпрж╝рзЗржмрж▓ржЧрзБрж▓рзЛрж░ ржирж╛ржо ржПржХржЗ рж╣рзЯрзЗ ржпрж╛рзЯ, рждржЦржи alias ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ рж╣рзЯ ржпрж╛рждрзЗ ржХржиржлрзНрж▓рж┐ржХрзНржЯ ржирж╛ рж╣рзЯред
- ржмрж┐рж╢рзЗрж╖ ржХрж░рзЗ **third-party packages** ржмрж╛ **external modules** ржмрзНржпржмрж╣рж╛рж░рзЗрж░ рж╕ржорзЯ alias ржжрж░ржХрж╛рж░ рж╣рзЯред

---

## ЁЯУж index.js ржлрж╛ржЗрж▓рзЗрж░ ржнрзВржорж┐ржХрж╛

ржЖржорж░рж╛ `index.js` ржирж╛ржорзЗ ржПржХржЯрж┐ ржлрж╛ржЗрж▓ ржирж┐ржЪрзНржЫрж┐ред

### ржХрж┐ржирзНрждрзБ ржХрзЗржи?

ржЖржорж╛ржжрзЗрж░ ржорзВрж▓ `main.js` ржлрж╛ржЗрж▓рзЗ ржпржжрж┐ ржПржХрж╛ржзрж┐ржХ ржлрж╛ржВрж╢ржи рж░рж┐ржХрзЛржпрж╝рзНржпрж╛рж░ ржХрж░рждрзЗ рж╣рзЯ, рждрж╛рж╣рж▓рзЗ ржкрзНрж░рждрж┐ржЯрж┐ utility ржлрж╛ржЗрж▓ ржерзЗржХрзЗ ржЖрж▓рж╛ржжрж╛ржнрж╛ржмрзЗ import ржХрж░рж╛ ржЭрж╛ржорзЗрж▓рж╛рж░ тАФ ржпрзЗржоржи:

```jsx
const add = require('./utils/add');
const subtract = require('./utils/subtract');
```

ржПрж░ ржкрж░рж┐ржмрж░рзНрждрзЗ ржЖржорж░рж╛ `index.js` ржлрж╛ржЗрж▓рзЗ рж╕ржм ржлрж╛ржВрж╢ржи ржПржХрждрзНрж░рзЗ export ржХрж░ржмрзЛ:

```jsx
// utils/index.js
const add = require('./add');
const subtract = require('./subtract');

module.exports = { add, subtract };
```

ржПржЦржи `main.js` ржлрж╛ржЗрж▓ ржерзЗржХрзЗ рж╕рж╣ржЬрзЗ рж░рж┐ржХрзЛржпрж╝рзНржпрж╛рж░ ржХрж░рж╛ ржпрж╛ржмрзЗ:

```jsx

const { add, subtract } = require('./utils');
```

---

## тЪая╕П index.js ржирж╛ ржерж╛ржХрж▓рзЗ ржХрзА рж╣рзЯ?

ржпржжрж┐ ржХрзЛржирзЛ ржлрзЛрж▓рзНржбрж╛рж░ рж░рж┐ржХрзЛржпрж╝рзНржпрж╛рж░ ржХрж░рж╛ рж╣рзЯ ржХрж┐ржирзНрждрзБ `index.js` ржирж╛ ржерж╛ржХрзЗ:

```jsx
const { add } = require('./utils');
```

рждрж╛рж╣рж▓рзЗ Node.js **error** ржжрж┐ржмрзЗ ржХрж╛рж░ржг рж╕рзЗ ржЬрж╛ржирзЗ ржирж╛ ржХрзЛржи ржлрж╛ржЗрж▓ржЯрж╛ ржПржХрзНрж╕ржкрзЛрж░рзНржЯ ржХрж░ржмрзЗред

### ржЙржжрж╛рж╣рж░ржг:

- `index.js` тЖТ тЭМ `index1.js` ржирж╛ржо ржжрж┐рж▓рзЗ
- рж░рж╛ржи ржХрж░рж╛рж░ рж╕ржорзЯ тЖТ тЭМ Error

Node.js ржлрзЛрж▓рзНржбрж╛рж░ ржерзЗржХрзЗ рж░рж┐ржХрзЛржпрж╝рзНржпрж╛рж░ ржХрж░рж╛рж░ рж╕ржорзЯ **default ржнрж╛ржмрзЗ `index.js` ржЦрзБржБржЬрзЗ**ред

---

## тЬЕ Smart Modular Pattern

ржЖржорж░рж╛ ржПржЦржи ржПржХржЯрж╛ рж╕рзНржорж╛рж░рзНржЯ ржХрж╛ржЬ ржХрж░рж▓рж╛ржо:

- `index.js` ржлрж╛ржЗрж▓рзЗ рж╕ржм utility function ржПржХрждрзНрж░рзЗ import ржПржмржВ export ржХрж░рж▓рж╛ржоред
- ржПржЦржи ржПржХ рж▓рж╛ржЗржирзЗ рж╕ржм ржлрж╛ржВрж╢ржи access ржХрж░рж╛ рж╕ржорзНржнржм рж╣рж▓рзЛред

```jsx
const { add, subtract, multiply } = require('./utils')
```

### тЬи рж╕рзБржмрж┐ржзрж╛рж╕ржорзВрж╣:

- тЬЕ ржХрзЛржб ржкрж░рж┐рж╖рзНржХрж╛рж░ рж╣рж▓рзЛ
- тЬЕ import ржЧрзБрж▓рзЛ рж╕рзБржирзНржжрж░ржнрж╛ржмрзЗ organize рж╣рж▓рзЛ
- тЬЕ ржПржХ рж▓рж╛ржЗржирзЗ рж╕ржм ржлрж╛ржВрж╢ржи access ржХрж░рж╛ ржЧрзЗрж▓
- тЬЕ ржХрзЛржб ржПржЦржи ржмрзЗрж╢рж┐ maintainable